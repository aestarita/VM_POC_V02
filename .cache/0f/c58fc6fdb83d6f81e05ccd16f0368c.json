{"id":"node_modules/@snap/camera-kit/lib/persistence/ExpiringPersistence.js","dependencies":[{"name":"C:\\Users\\aesta\\Documents\\GitHub\\VM_POC_V02\\node_modules\\@snap\\camera-kit\\lib\\persistence\\ExpiringPersistence.js.map","includedInParent":true,"mtime":1689894620919},{"name":"C:\\Users\\aesta\\Documents\\GitHub\\VM_POC_V02\\package.json","includedInParent":true,"mtime":1689971043690},{"name":"C:\\Users\\aesta\\Documents\\GitHub\\VM_POC_V02\\node_modules\\@snap\\camera-kit\\package.json","includedInParent":true,"mtime":1689894620849},{"name":"tslib","loc":{"line":1,"column":26,"index":26},"parent":"C:\\Users\\aesta\\Documents\\GitHub\\VM_POC_V02\\node_modules\\@snap\\camera-kit\\lib\\persistence\\ExpiringPersistence.js","resolved":"C:\\Users\\aesta\\Documents\\GitHub\\VM_POC_V02\\node_modules\\@snap\\camera-kit\\node_modules\\tslib\\tslib.es6.js"},{"name":"../common/errorHelpers","loc":{"line":2,"column":28,"index":63},"parent":"C:\\Users\\aesta\\Documents\\GitHub\\VM_POC_V02\\node_modules\\@snap\\camera-kit\\lib\\persistence\\ExpiringPersistence.js","resolved":"C:\\Users\\aesta\\Documents\\GitHub\\VM_POC_V02\\node_modules\\@snap\\camera-kit\\lib\\common\\errorHelpers.js"},{"name":"../logger/logger","loc":{"line":3,"column":26,"index":115},"parent":"C:\\Users\\aesta\\Documents\\GitHub\\VM_POC_V02\\node_modules\\@snap\\camera-kit\\lib\\persistence\\ExpiringPersistence.js","resolved":"C:\\Users\\aesta\\Documents\\GitHub\\VM_POC_V02\\node_modules\\@snap\\camera-kit\\lib\\logger\\logger.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ExpiringPersistence = void 0;\nvar _tslib = require(\"tslib\");\nvar _errorHelpers = require(\"../common/errorHelpers\");\nvar _logger = require(\"../logger/logger\");\nconst logger = (0, _logger.getLogger)(\"ExpiringPersistence\");\n/**\n * Create a Persistence that will remove entries after they expire.\n *\n * An expiration function must be provided, which is called each time a value is stored. It must return the expiration\n * time for that value, given in seconds from now. For example, to expire a value 24 hours after it is stored, the\n * expiration function should return 86400 (the number of seconds in 24 hours).\n */\nclass ExpiringPersistence {\n  constructor(expiration, persistence) {\n    this.expiration = expiration;\n    this.persistence = persistence;\n  }\n  get size() {\n    return this.persistence.size;\n  }\n  retrieve(key) {\n    var _a;\n    return (0, _tslib.__awaiter)(this, void 0, void 0, function* () {\n      const [expiry, value] = (_a = yield this.persistence.retrieve(key)) !== null && _a !== void 0 ? _a : [];\n      if (value === undefined || expiry === undefined) return undefined;\n      if (Date.now() > expiry) {\n        yield this.persistence.remove(key).catch(error => {\n          logger.warn(`Key ${key} is expired, but removing it from persistence failed.`, (0, _errorHelpers.ensureError)(error));\n        });\n        return undefined;\n      }\n      return value;\n    });\n  }\n  retrieveAll() {\n    return (0, _tslib.__awaiter)(this, void 0, void 0, function* () {\n      const now = Date.now();\n      return (yield this.persistence.retrieveAll()).filter(([expiry]) => expiry >= now).map(([, v]) => v);\n    });\n  }\n  remove(key) {\n    return this.persistence.remove(key);\n  }\n  removeAll() {\n    return (0, _tslib.__awaiter)(this, void 0, void 0, function* () {\n      const results = yield this.persistence.removeAll();\n      return results.map(([, v]) => v);\n    });\n  }\n  store(keyOrValue, maybeValue) {\n    const [key, value] = maybeValue === undefined ? [undefined, keyOrValue] : [keyOrValue, maybeValue];\n    const expiry = Date.now() + this.expiration(value) * 1000;\n    return key === undefined ? this.persistence.store([expiry, value]) : this.persistence.store(key, [expiry, value]);\n  }\n}\nexports.ExpiringPersistence = ExpiringPersistence;"},"sourceMaps":{"js":{"mappings":[{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":8,"column":0}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":8,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":8,"column":17}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":8,"column":20}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":8,"column":27}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":9,"column":0}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":9,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":9,"column":11}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":9,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":9,"column":21}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":10,"column":0}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":5,"column":6},"generated":{"line":10,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":5,"column":12},"generated":{"line":10,"column":12}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":5,"column":15},"generated":{"line":10,"column":15}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":5,"column":15},"generated":{"line":10,"column":19}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":5,"column":24},"generated":{"line":10,"column":36}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":5,"column":25},"generated":{"line":10,"column":38}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":5,"column":46},"generated":{"line":10,"column":59}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":5,"column":47},"generated":{"line":10,"column":60}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":11,"column":0}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":14,"column":6},"generated":{"line":18,"column":0}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":14,"column":13},"generated":{"line":18,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":14,"column":32},"generated":{"line":18,"column":25}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":14,"column":32},"generated":{"line":18,"column":26}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":15,"column":4},"generated":{"line":19,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":15,"column":4},"generated":{"line":19,"column":13}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":16,"column":25},"generated":{"line":19,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":16,"column":57},"generated":{"line":19,"column":24}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":17,"column":25},"generated":{"line":19,"column":26}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":17,"column":62},"generated":{"line":19,"column":37}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":17,"column":62},"generated":{"line":19,"column":39}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":16,"column":25},"generated":{"line":20,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":16,"column":25},"generated":{"line":20,"column":8}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":16,"column":25},"generated":{"line":20,"column":9}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":16,"column":35},"generated":{"line":20,"column":19}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":16,"column":25},"generated":{"line":20,"column":22}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":16,"column":35},"generated":{"line":20,"column":32}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":17,"column":25},"generated":{"line":21,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":17,"column":25},"generated":{"line":21,"column":8}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":17,"column":25},"generated":{"line":21,"column":9}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":17,"column":36},"generated":{"line":21,"column":20}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":17,"column":25},"generated":{"line":21,"column":23}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":17,"column":36},"generated":{"line":21,"column":34}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":18,"column":7},"generated":{"line":22,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":23,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":20,"column":8},"generated":{"line":23,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":20,"column":12},"generated":{"line":23,"column":10}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":20,"column":12},"generated":{"line":23,"column":11}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":20,"column":12},"generated":{"line":23,"column":13}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":21,"column":8},"generated":{"line":24,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":21,"column":15},"generated":{"line":24,"column":11}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":21,"column":19},"generated":{"line":24,"column":15}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":21,"column":20},"generated":{"line":24,"column":16}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":21,"column":31},"generated":{"line":24,"column":27}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":21,"column":32},"generated":{"line":24,"column":28}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":21,"column":36},"generated":{"line":24,"column":32}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":22,"column":4},"generated":{"line":25,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":24,"column":10},"generated":{"line":26,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":24,"column":18},"generated":{"line":26,"column":10}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":24,"column":19},"generated":{"line":26,"column":11}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":24,"column":32},"generated":{"line":26,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":24,"column":32},"generated":{"line":26,"column":16}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":8},"generated":{"line":29,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":14},"generated":{"line":29,"column":12}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":15},"generated":{"line":29,"column":13}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":21},"generated":{"line":29,"column":19}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":23},"generated":{"line":29,"column":21}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":28},"generated":{"line":29,"column":26}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":29},"generated":{"line":29,"column":27}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":32},"generated":{"line":29,"column":30}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":32},"generated":{"line":29,"column":31}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":32},"generated":{"line":29,"column":33}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":33},"generated":{"line":29,"column":36}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":39},"generated":{"line":29,"column":42}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":43},"generated":{"line":29,"column":46}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":44},"generated":{"line":29,"column":47}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":55},"generated":{"line":29,"column":58}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":56},"generated":{"line":29,"column":59}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":64},"generated":{"line":29,"column":67}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":65},"generated":{"line":29,"column":68}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":68},"generated":{"line":29,"column":71}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":72}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":78}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":82}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":86}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":88}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":93}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":98}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":99}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":102}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":70},"generated":{"line":29,"column":104}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":74},"generated":{"line":29,"column":107}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":25,"column":76},"generated":{"line":29,"column":109}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":8},"generated":{"line":30,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":12},"generated":{"line":30,"column":10}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":17},"generated":{"line":30,"column":15}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":22},"generated":{"line":30,"column":20}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":31},"generated":{"line":30,"column":29}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":35},"generated":{"line":30,"column":33}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":41},"generated":{"line":30,"column":39}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":46},"generated":{"line":30,"column":44}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":55},"generated":{"line":30,"column":53}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":57},"generated":{"line":30,"column":55}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":64},"generated":{"line":30,"column":62}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":26,"column":73},"generated":{"line":30,"column":71}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":8},"generated":{"line":31,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":12},"generated":{"line":31,"column":10}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":16},"generated":{"line":31,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":17},"generated":{"line":31,"column":15}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":20},"generated":{"line":31,"column":18}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":20},"generated":{"line":31,"column":19}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":22},"generated":{"line":31,"column":20}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":25},"generated":{"line":31,"column":23}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":31},"generated":{"line":31,"column":29}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":28,"column":33},"generated":{"line":31,"column":31}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":12},"generated":{"line":32,"column":8}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":18},"generated":{"line":32,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":22},"generated":{"line":32,"column":18}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":23},"generated":{"line":32,"column":19}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":34},"generated":{"line":32,"column":30}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":35},"generated":{"line":32,"column":31}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":41},"generated":{"line":32,"column":37}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":42},"generated":{"line":32,"column":38}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":45},"generated":{"line":32,"column":41}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":46},"generated":{"line":32,"column":42}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":47},"generated":{"line":32,"column":43}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":52},"generated":{"line":32,"column":48}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":54},"generated":{"line":32,"column":49}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":59},"generated":{"line":32,"column":54}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":29,"column":63},"generated":{"line":32,"column":58}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":16},"generated":{"line":33,"column":10}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":22},"generated":{"line":33,"column":16}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":23},"generated":{"line":33,"column":17}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":27},"generated":{"line":33,"column":21}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":28},"generated":{"line":33,"column":22}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":35},"generated":{"line":33,"column":29}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":38},"generated":{"line":33,"column":32}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":93},"generated":{"line":33,"column":87}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":95},"generated":{"line":33,"column":89}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":95},"generated":{"line":33,"column":93}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":106},"generated":{"line":33,"column":118}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":107},"generated":{"line":33,"column":120}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":112},"generated":{"line":33,"column":125}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":113},"generated":{"line":33,"column":126}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":30,"column":114},"generated":{"line":33,"column":127}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":31,"column":12},"generated":{"line":34,"column":8}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":31,"column":13},"generated":{"line":34,"column":9}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":31,"column":14},"generated":{"line":34,"column":10}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":32,"column":12},"generated":{"line":35,"column":8}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":32,"column":19},"generated":{"line":35,"column":15}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":32,"column":28},"generated":{"line":35,"column":24}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":34,"column":8},"generated":{"line":37,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":34,"column":15},"generated":{"line":37,"column":13}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":34,"column":20},"generated":{"line":37,"column":18}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":37,"column":10},"generated":{"line":40,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":37,"column":21},"generated":{"line":40,"column":13}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":37,"column":21},"generated":{"line":40,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":37,"column":21},"generated":{"line":40,"column":16}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":38,"column":8},"generated":{"line":42,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":38,"column":14},"generated":{"line":42,"column":12}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":38,"column":17},"generated":{"line":42,"column":15}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":38,"column":20},"generated":{"line":42,"column":18}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":38,"column":24},"generated":{"line":42,"column":22}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":38,"column":25},"generated":{"line":42,"column":23}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":38,"column":28},"generated":{"line":42,"column":26}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":38,"column":28},"generated":{"line":42,"column":27}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":38,"column":30},"generated":{"line":42,"column":28}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":8},"generated":{"line":43,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":15},"generated":{"line":43,"column":13}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":16},"generated":{"line":43,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":22},"generated":{"line":43,"column":20}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":26},"generated":{"line":43,"column":24}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":27},"generated":{"line":43,"column":25}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":38},"generated":{"line":43,"column":36}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":39},"generated":{"line":43,"column":37}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":50},"generated":{"line":43,"column":48}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":50},"generated":{"line":43,"column":49}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":52},"generated":{"line":43,"column":50}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":54},"generated":{"line":43,"column":52}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":60},"generated":{"line":43,"column":58}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":61},"generated":{"line":43,"column":59}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":62},"generated":{"line":43,"column":60}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":63},"generated":{"line":43,"column":61}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":69},"generated":{"line":43,"column":67}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":70},"generated":{"line":43,"column":68}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":75},"generated":{"line":43,"column":73}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":81},"generated":{"line":43,"column":79}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":85},"generated":{"line":43,"column":83}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":88},"generated":{"line":43,"column":86}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":89},"generated":{"line":43,"column":87}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":90},"generated":{"line":43,"column":88}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":93},"generated":{"line":43,"column":91}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":94},"generated":{"line":43,"column":92}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":95},"generated":{"line":43,"column":93}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":98},"generated":{"line":43,"column":96}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":99},"generated":{"line":43,"column":97}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":100},"generated":{"line":43,"column":98}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":105},"generated":{"line":43,"column":103}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":106},"generated":{"line":43,"column":104}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":39,"column":107},"generated":{"line":43,"column":105}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":40,"column":4},"generated":{"line":44,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":40,"column":5},"generated":{"line":44,"column":5}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":40,"column":5},"generated":{"line":44,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":42,"column":4},"generated":{"line":46,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":42,"column":10},"generated":{"line":46,"column":8}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":42,"column":11},"generated":{"line":46,"column":9}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":42,"column":24},"generated":{"line":46,"column":12}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":42,"column":24},"generated":{"line":46,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":8},"generated":{"line":47,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":15},"generated":{"line":47,"column":11}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":19},"generated":{"line":47,"column":15}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":20},"generated":{"line":47,"column":16}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":31},"generated":{"line":47,"column":27}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":32},"generated":{"line":47,"column":28}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":38},"generated":{"line":47,"column":34}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":39},"generated":{"line":47,"column":35}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":42},"generated":{"line":47,"column":38}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":43,"column":43},"generated":{"line":47,"column":39}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":44,"column":4},"generated":{"line":48,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":46,"column":10},"generated":{"line":49,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":46,"column":19},"generated":{"line":49,"column":11}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":46,"column":19},"generated":{"line":49,"column":12}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":46,"column":19},"generated":{"line":49,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":8},"generated":{"line":51,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":14},"generated":{"line":51,"column":12}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":21},"generated":{"line":51,"column":19}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":24},"generated":{"line":51,"column":22}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":30},"generated":{"line":51,"column":28}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":34},"generated":{"line":51,"column":32}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":35},"generated":{"line":51,"column":33}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":46},"generated":{"line":51,"column":44}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":47},"generated":{"line":51,"column":45}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":56},"generated":{"line":51,"column":54}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":56},"generated":{"line":51,"column":55}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":47,"column":58},"generated":{"line":51,"column":56}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":8},"generated":{"line":52,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":15},"generated":{"line":52,"column":13}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":22},"generated":{"line":52,"column":20}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":23},"generated":{"line":52,"column":21}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":26},"generated":{"line":52,"column":24}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":27},"generated":{"line":52,"column":25}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":28},"generated":{"line":52,"column":26}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":31},"generated":{"line":52,"column":29}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":32},"generated":{"line":52,"column":30}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":33},"generated":{"line":52,"column":31}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":38},"generated":{"line":52,"column":36}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":39},"generated":{"line":52,"column":37}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":48,"column":40},"generated":{"line":52,"column":38}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":53,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":49,"column":5},"generated":{"line":53,"column":5}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":49,"column":5},"generated":{"line":53,"column":6}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":53,"column":4},"generated":{"line":55,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":53,"column":9},"generated":{"line":55,"column":7}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":53,"column":10},"generated":{"line":55,"column":8}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":53,"column":34},"generated":{"line":55,"column":18}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":53,"column":36},"generated":{"line":55,"column":20}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":53,"column":50},"generated":{"line":55,"column":30}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":53,"column":50},"generated":{"line":55,"column":32}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":54,"column":8},"generated":{"line":56,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":54,"column":14},"generated":{"line":56,"column":10}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":54,"column":15},"generated":{"line":56,"column":11}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":54,"column":18},"generated":{"line":56,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":54,"column":20},"generated":{"line":56,"column":16}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":54,"column":25},"generated":{"line":56,"column":21}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":54,"column":26},"generated":{"line":56,"column":22}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":12},"generated":{"line":56,"column":25}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":22},"generated":{"line":56,"column":35}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":27},"generated":{"line":56,"column":40}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":36},"generated":{"line":56,"column":49}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":39},"generated":{"line":56,"column":52}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":40},"generated":{"line":56,"column":53}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":49},"generated":{"line":56,"column":62}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":51},"generated":{"line":56,"column":64}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":66},"generated":{"line":56,"column":74}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":67},"generated":{"line":56,"column":75}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":70},"generated":{"line":56,"column":78}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":71},"generated":{"line":56,"column":79}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":93},"generated":{"line":56,"column":89}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":95},"generated":{"line":56,"column":91}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":105},"generated":{"line":56,"column":101}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":55,"column":106},"generated":{"line":56,"column":102}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":8},"generated":{"line":57,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":14},"generated":{"line":57,"column":10}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":20},"generated":{"line":57,"column":16}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":23},"generated":{"line":57,"column":19}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":27},"generated":{"line":57,"column":23}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":28},"generated":{"line":57,"column":24}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":31},"generated":{"line":57,"column":27}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":31},"generated":{"line":57,"column":28}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":33},"generated":{"line":57,"column":29}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":36},"generated":{"line":57,"column":32}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":40},"generated":{"line":57,"column":36}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":41},"generated":{"line":57,"column":37}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":51},"generated":{"line":57,"column":47}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":52},"generated":{"line":57,"column":48}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":57},"generated":{"line":57,"column":53}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":58},"generated":{"line":57,"column":54}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":61},"generated":{"line":57,"column":57}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":56,"column":65},"generated":{"line":57,"column":61}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":57,"column":8},"generated":{"line":58,"column":4}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":57,"column":15},"generated":{"line":58,"column":11}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":57,"column":18},"generated":{"line":58,"column":14}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":57,"column":23},"generated":{"line":58,"column":19}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":57,"column":32},"generated":{"line":58,"column":28}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":14},"generated":{"line":58,"column":31}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":18},"generated":{"line":58,"column":35}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":19},"generated":{"line":58,"column":36}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":30},"generated":{"line":58,"column":47}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":31},"generated":{"line":58,"column":48}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":36},"generated":{"line":58,"column":53}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":37},"generated":{"line":58,"column":54}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":38},"generated":{"line":58,"column":55}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":44},"generated":{"line":58,"column":61}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":46},"generated":{"line":58,"column":63}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":51},"generated":{"line":58,"column":68}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":52},"generated":{"line":58,"column":69}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":58,"column":53},"generated":{"line":58,"column":70}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":14},"generated":{"line":58,"column":73}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":18},"generated":{"line":58,"column":77}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":19},"generated":{"line":58,"column":78}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":30},"generated":{"line":58,"column":89}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":31},"generated":{"line":58,"column":90}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":36},"generated":{"line":58,"column":95}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":37},"generated":{"line":58,"column":96}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":40},"generated":{"line":58,"column":99}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":42},"generated":{"line":58,"column":101}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":43},"generated":{"line":58,"column":102}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":49},"generated":{"line":58,"column":108}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":51},"generated":{"line":58,"column":110}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":56},"generated":{"line":58,"column":115}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":57},"generated":{"line":58,"column":116}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":59,"column":58},"generated":{"line":58,"column":117}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":60,"column":4},"generated":{"line":59,"column":2}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":61,"column":1},"generated":{"line":61,"column":0}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":61,"column":1},"generated":{"line":61,"column":7}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":61,"column":1},"generated":{"line":61,"column":8}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":61,"column":1},"generated":{"line":61,"column":27}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":61,"column":1},"generated":{"line":61,"column":30}},{"source":"../../src/persistence/ExpiringPersistence.ts","name":null,"original":{"line":61,"column":1},"generated":{"line":61,"column":49}}],"sources":{"../../src/persistence/ExpiringPersistence.ts":"import { ensureError } from \"../common/errorHelpers\";\nimport { getLogger } from \"../logger/logger\";\nimport { Persistence, ValidKey } from \"./Persistence\";\n\nconst logger = getLogger(\"ExpiringPersistence\");\n\n/**\n * Create a Persistence that will remove entries after they expire.\n *\n * An expiration function must be provided, which is called each time a value is stored. It must return the expiration\n * time for that value, given in seconds from now. For example, to expire a value 24 hours after it is stored, the\n * expiration function should return 86400 (the number of seconds in 24 hours).\n */\nexport class ExpiringPersistence<T> implements Persistence<T> {\n    constructor(\n        private readonly expiration: (value: T) => number,\n        private readonly persistence: Persistence<[number, T]>\n    ) {}\n\n    get size(): number {\n        return this.persistence.size;\n    }\n\n    async retrieve(key: ValidKey): Promise<T | undefined> {\n        const [expiry, value] = (await this.persistence.retrieve(key)) ?? [];\n        if (value === undefined || expiry === undefined) return undefined;\n\n        if (Date.now() > expiry) {\n            await this.persistence.remove(key).catch((error) => {\n                logger.warn(`Key ${key} is expired, but removing it from persistence failed.`, ensureError(error));\n            });\n            return undefined;\n        }\n        return value;\n    }\n\n    async retrieveAll(): Promise<T[]> {\n        const now = Date.now();\n        return (await this.persistence.retrieveAll()).filter(([expiry]) => expiry >= now).map(([, v]) => v);\n    }\n\n    remove(key: ValidKey): Promise<void> {\n        return this.persistence.remove(key);\n    }\n\n    async removeAll(): Promise<T[]> {\n        const results = await this.persistence.removeAll();\n        return results.map(([, v]) => v);\n    }\n\n    store(value: T): Promise<ValidKey>;\n    store(key: ValidKey, value: T): Promise<ValidKey>;\n    store(keyOrValue: T | ValidKey, maybeValue?: T): Promise<ValidKey> {\n        const [key, value] =\n            maybeValue === undefined ? [undefined, keyOrValue as T] : [keyOrValue as ValidKey, maybeValue];\n        const expiry = Date.now() + this.expiration(value) * 1000;\n        return key === undefined\n            ? this.persistence.store([expiry, value])\n            : this.persistence.store(key, [expiry, value]);\n    }\n}\n"},"lineCount":null}},"error":null,"hash":"b7930bf120d81570630550aa1a7a9bb2","cacheData":{"env":{}}}